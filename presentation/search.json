[
  {
    "objectID": "index.html#what-is-cicd",
    "href": "index.html#what-is-cicd",
    "title": "CI/CD in the {pharmaverse}",
    "section": "What is CI/CD?",
    "text": "What is CI/CD?\n\nContinuous Integration (CI): Frequent merging of several small changes into a main branch\nContinuous Delivery (CD): Repeatable deployment process when deciding to deploy\n\nCI/CD bridges the gaps between development and operation activities and teams by enforcing automation in building, testing and deployment of applications. CI/CD services compile the incremental code changes made by developers, then link and package them into software deliverables\n\n\n\n\n\n\n\n\n\n\n\n\nWikipedia: CI/CD {pharmaverse}"
  },
  {
    "objectID": "index.html#does-it-help",
    "href": "index.html#does-it-help",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Does it help?",
    "text": "Does it help?\n\n\n\n\n\n…Yes! Yes, it does!!\n\n\n\nXKCD"
  },
  {
    "objectID": "index.html#how-does-cicd-help-r-packages",
    "href": "index.html#how-does-cicd-help-r-packages",
    "title": "CI/CD in the {pharmaverse}",
    "section": "How does CI/CD help R packages?",
    "text": "How does CI/CD help R packages?\n\n\nCatch issues (bugs) early on\nUser base on multiple OSes and multiple R versions\nFaster turnaround on Code Review\nMultiple Contributors on your R Package\nEnforce style conventions and preferences\nMeasure test coverage for new code\nKeep docs up-to-date\nAnd we can just keep going!"
  },
  {
    "objectID": "index.html#what-could-standard-cicd-for-r-packages-look-like",
    "href": "index.html#what-could-standard-cicd-for-r-packages-look-like",
    "title": "CI/CD in the {pharmaverse}",
    "section": "What could standard CI/CD for R packages look like?",
    "text": "What could standard CI/CD for R packages look like?\n\nNot all R packages are the same, but they are still pretty similar!\n\n\n\n\nUnit Tests\nLink & URL Checks\nSpelling Checks\nStatic Code Analysis\n\n\n\nManual Pages\nCode Style\nR-CMD check\nPublishing a pkgdown site\n\n \n\nWe just did all these in the R/Pharma Workshop: Intro to CI/CD for R Packages"
  },
  {
    "objectID": "index.html#about-admiral",
    "href": "index.html#about-admiral",
    "title": "CI/CD in the {pharmaverse}",
    "section": "About admiral",
    "text": "About admiral\n\n\n\n\nProvide an open source, modularized toolbox that enables the pharmaceutical programming community to develop ADaM datasets in R.\nADaM is one of the required standards for data submission to FDA (U.S.) and PMDA (Japan) for clinical trials\nLinks\n\nCDISC\nhttps://github.com/pharmaverse/admiral\n\nIssue 1: Checking ADaM Template code\nIssue 2: Common CI/CD for the admiral family of packages"
  },
  {
    "objectID": "index.html#issue-1-check-templates",
    "href": "index.html#issue-1-check-templates",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Issue 1: Check Templates",
    "text": "Issue 1: Check Templates\n\n\n\nCreate a reference files to build common ADaM datasets that shows users how to implement our functions\nWay less text then a Vignette - Code is ready to go and build a dataset!\nWhere we store this code is not check by R-CMD.\nHow to ensure code stays up to date with deprecated functions or unforseen bugs get in from functions working together?\nCI/CD for the win!"
  },
  {
    "objectID": "index.html#cicd-for-templates",
    "href": "index.html#cicd-for-templates",
    "title": "CI/CD in the {pharmaverse}",
    "section": "CI/CD for Templates",
    "text": "CI/CD for Templates\n\n\n\nAfter a Code Review the template code is executed\nIf any errors or warnings are detected the CI/CD check fails and the contributor must fix the error or warning."
  },
  {
    "objectID": "index.html#issue-2-admiral-upstream-and-downstream-dependencies",
    "href": "index.html#issue-2-admiral-upstream-and-downstream-dependencies",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Issue 2: admiral upstream and downstream dependencies",
    "text": "Issue 2: admiral upstream and downstream dependencies\n\n\n\nAs you can imagine there can be a lot of different types of ADaMs!\nExtension packages focus on specific disease areas like oncology\nThe admiral family has a package for developers, template R package repo, dummy data\nEek!! How to keep this all in line!"
  },
  {
    "objectID": "index.html#issue-2-common-cicd-workflows-for-admiral-upstream-and-downstream-dependencies",
    "href": "index.html#issue-2-common-cicd-workflows-for-admiral-upstream-and-downstream-dependencies",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Issue 2: Common CI/CD workflows for admiral upstream and downstream dependencies",
    "text": "Issue 2: Common CI/CD workflows for admiral upstream and downstream dependencies\n\n\n\nAs you can imagine there can be a lot of different types of ADaMs!\nExtension packages focus on specific disease areas like oncology\nThe admiral family has a package for developers, template R package repo, dummy data\nEek!! How to keep this all in line!"
  },
  {
    "objectID": "index.html#need-to-give-confidence-that-our-package-is-reliable",
    "href": "index.html#need-to-give-confidence-that-our-package-is-reliable",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Need to give confidence that our package is reliable",
    "text": "Need to give confidence that our package is reliable\nCICD “validation” job to create a small report that emulates the sort of validation reports that get made locally"
  },
  {
    "objectID": "index.html#shiny-app-testing",
    "href": "index.html#shiny-app-testing",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Shiny App Testing",
    "text": "Shiny App Testing\nHow NEST run Shiny apps tests"
  },
  {
    "objectID": "index.html#about-rbmi",
    "href": "index.html#about-rbmi",
    "title": "CI/CD in the {pharmaverse}",
    "section": "About RBMI",
    "text": "About RBMI\n\n\n\n\nReference Based Multiple Imputation\nImplements imputation for longitudinal data in accordance with the ICH E9(R1) Addendum on Estimands\nAcknowledgements to Alessandro Noci, Marcel Wolbers & Daniel Sabanes Bove\nLinks\n\nhttps://arxiv.org/abs/2109.11162\nhttps://github.com/insightsengineering/rbmi\n\n\n\n\n\n\n\nKey component of the package is that many of the methods rely on resampling techniques to generate confidence intervals. This requires fitting potentially 1000’s of MMRM models which means run times tend to be in the order of minutes to hours for a full run of the package depending on the size of the data"
  },
  {
    "objectID": "index.html#package-development-problems",
    "href": "index.html#package-development-problems",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Package Development Problems",
    "text": "Package Development Problems\n\n\nInstallation takes >3 minutes to compile STAN code\nFull test suite takes >50 minutes to run\nVignettes took >5 minutes to run\nNeed to release on in-house servers running legacy versions of R\nMany PR’s forgot to run devtools::document()\nMany PR’s forgot to rebuild pkgdown site\n\n\n\n\n\n2 key issues that we are about to cover: - Need to get run times down to <10 minutes - Need to ensure package works both on internal server and CRAN"
  },
  {
    "objectID": "index.html#solution-1---reducing-the-test-suite-runtime",
    "href": "index.html#solution-1---reducing-the-test-suite-runtime",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Solution 1 - Reducing the Test Suite Runtime",
    "text": "Solution 1 - Reducing the Test Suite Runtime\n\n\ntests/testthat/test-bigtest.R\n\ntest_that(\"Some long running section\", {\n  \n    skip_if_not(Sys.getenv(\"R_TEST_FULL\") == \"TRUE\")\n    \n    # <rest of the test code>\n    \n})\n\n\n\n.github/workflows/on_biweekly.yaml\n\non:\n  schedule:\n    - cron: '0 4 1,15 * *'\n\njobs:\n  rcmdcheck-main:\n    env:\n      R_TEST_FULL: 'TRUE' \n    steps:\n      - name: Checkout\n        uses: actions/checkout@v3\n      - name: Check\n        uses: ./.github/actions/rcmdcheck\n\n\n\nUse of skip-if-not + environment variable to conditionally control which tests get executed\nUse of CICD to ensure that the skipped tests do still get run on a period basis"
  },
  {
    "objectID": "index.html#solution-1---reducing-the-test-suite-runtime-1",
    "href": "index.html#solution-1---reducing-the-test-suite-runtime-1",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Solution 1 - Reducing the Test Suite Runtime",
    "text": "Solution 1 - Reducing the Test Suite Runtime\n\n\n.vscode/tasks.json\n\n{\n    \"version\": \"2.0.0\",\n    \"tasks\": [\n        {\n            \"label\": \"R - testthat (FULL)\",\n            \"command\": \"Rscript\",\n            \"options\": { \"env\": { \"R_TEST_FULL\" : \"TRUE\" } },\n            \"args\": [\"-e\", \"devtools::test()\"],\n            \"group\": \"test\"\n        }\n    ]\n}\n\n\n\nSmall plug for VScode that you can use it to execute tasks where you fix the environment variable in order to run the full test suite locally"
  },
  {
    "objectID": "index.html#solution-2---reducing-the-vignette-runtime",
    "href": "index.html#solution-2---reducing-the-vignette-runtime",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Solution 2 - Reducing the Vignette Runtime",
    "text": "Solution 2 - Reducing the Vignette Runtime\n\n\nDESCRIPTION\n\nSuggests: R.rsp\nVignetteBuilder: R.rsp\n\n\nvignettes/quickstart.Rmd\n\n---\ntitle: \"rbmi: Quickstart\"\nauthor: Craig Gower-Page, Alessandro Noci, and Marcel Wolbers\noutput: \n  bookdown::html_document2:\n    toc: true\n    toc_depth: 4\n---\n\n\nvignettes/quickstart.html.asis\n\n%\\VignetteIndexEntry{rbmi: Quickstart}\n%\\VignetteEngine{R.rsp::asis}\n\n\nUse of R.rsp package to use “asis” vignette builder\nThis is where we make the vignettes locally in advance and directly add them to the repo\nWhen R “builds” the vignette it simply just uses the pre-built file asis without re-running it\nThis opens up a problem though of how do we know if the vignette is up-to-date or even runs properly anymore?"
  },
  {
    "objectID": "index.html#solution-2---reducing-the-vignette-runtime-1",
    "href": "index.html#solution-2---reducing-the-vignette-runtime-1",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Solution 2 - Reducing the Vignette Runtime",
    "text": "Solution 2 - Reducing the Vignette Runtime\n\n\n.github/workflow/on_pr.yaml\n\n  vignettes:\n    runs-on: ubuntu-latest\n    container:\n      image: \"ghcr.io/insightsengineering/rbmi:latest\"\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v3\n      - name: Build Vignettes\n        run: |\n          Rscript ./vignettes/build.R\n\n\n\n\n\nWe thus have a dedicated CICD job specifically to re-build the vignette.\nThis way Vignette execution is doing in parallel to the running of the test suite\nTrade off here though is that it means our vignettes are never executed on CRANs servers\nThis trade-off can be partially mitigated by setting up our own CICD process to use a variety of different OS’s / machine builds"
  },
  {
    "objectID": "index.html#solution-3---reducing-code-compilation-time",
    "href": "index.html#solution-3---reducing-code-compilation-time",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Solution 3 - Reducing code Compilation Time",
    "text": "Solution 3 - Reducing code Compilation Time\n\n\n.github/actions/build-src/action.yml\n\n    - name: Cache Compiled Stan Code\n      id: cache-pkgs\n      uses: actions/cache@v3\n      with:\n        path: src/*\n\n\n\n\n\nMain point is compiling code (in our case stan code) can take a ton of time\nWe use githubs cache feature to restore the compiled code from previous builds to save that time\nCon is that care with the configuration is required to ensure you aren’t loading say MAC binaries on a windows image\nScreenshot just shows the run time of the compile code “build src” is very low compared to the usual 2-5 minutes"
  },
  {
    "objectID": "index.html#solution-4---testing-against-in-house-servers",
    "href": "index.html#solution-4---testing-against-in-house-servers",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Solution 4 - Testing Against In-House Servers",
    "text": "Solution 4 - Testing Against In-House Servers\n\n\n\n\n\n\nUse of docker files to emulate our in-house servers\nHad double benefit of drastically reducing package install times on standard push / pr builds as all required dependencies are already installed and ready to go"
  },
  {
    "objectID": "index.html#solution-4---testing-against-in-house-servers-1",
    "href": "index.html#solution-4---testing-against-in-house-servers-1",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Solution 4 - Testing Against In-House Servers",
    "text": "Solution 4 - Testing Against In-House Servers\n\n\n.github/workflows/build_docker.yaml\n\non:\n  push:\n    paths:\n      - 'misc/docker/**'\n\njobs:\n  build:\n    steps:\n      - name: Checkout repository \n        uses: actions/checkout@v2\n      \n      - name: Set up Docker Buildx\n        uses: docker/setup-buildx-action@v1\n      \n      - name: Build and push image \n        uses: docker/build-push-action@v2\n\n\nMain point here is the targeted use of “paths” to only rebuild and redeploy our docker images when a change has occured in the docker directory\nThe Job code is pretty redundent here as it misses a load of stuff to ensure if can fit on the screen however hopefully it just gives some flavour of a job to build a docker file"
  },
  {
    "objectID": "index.html#solution-4---testing-against-in-house-servers-2",
    "href": "index.html#solution-4---testing-against-in-house-servers-2",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Solution 4 - Testing Against In-House Servers",
    "text": "Solution 4 - Testing Against In-House Servers\n\n\n.github/workflows/on_pr_main.yaml\n\njobs:\n  rcmdcheck:\n    strategy:\n      matrix:\n       config:\n        - { image: \"ghcr.io/insightsengineering/rbmi:r404\"}\n        - { image: \"ghcr.io/insightsengineering/rbmi:r410\"}\n        - { image: \"ghcr.io/insightsengineering/rbmi:latest\"}\n    runs-on: ubuntu-latest\n    container:\n      image: ${{ matrix.config.image }}\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v3\n        \n      - name: Build src\n        uses: ./.github/actions/build-src\n        \n      - name: Check\n        uses: ./.github/actions/rcmdcheck\n\n\nFinal bit on this is just to highlight that we can use githubs matrix feature to ensure that our job is run against all the different combination of images and r versions that we want to ensure we can support"
  },
  {
    "objectID": "index.html#backup---non-r-package-uses-of-cicd",
    "href": "index.html#backup---non-r-package-uses-of-cicd",
    "title": "CI/CD in the {pharmaverse}",
    "section": "Backup - Non R Package uses of CI/CD",
    "text": "Backup - Non R Package uses of CI/CD\n - automatically re-running your analysis on a code change (or sub-sections) - automatically deploying TLGs to your document repository upon succsessul PROD run - Automatically deploying VADs to your database / data repository upon sucsessful PROD run\n\n\n\n\n\n<CI-CD GitHub>"
  }
]